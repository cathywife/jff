# See slapd-config(5)

### optimize database ######################################

dn: olcDatabase={1}hdb,cn=config
changetype: modify
add: olcDbIndex
olcDbIndex: default sub
-
add: olcDbIndex
olcDbIndex: cn,sn,uid,displayName pres,sub,eq
-
add: olcDbIndex
olcDbIndex: uidNumber,gidNumber,dc eq
-
add: olcDbIndex
olcDbIndex: mail,givenName eq,subinitial
-


### authc id rewritting for authz id #########################
dn: cn=config
changetype: modify
add: olcAuthIDRewrite
olcAuthIDRewrite: 
-
add: olcAuthzRegexp
olcAuthzRegexp: 
-
replace: olcAuthzPolicy
olcAuthzPolicy: any
-


# XXX: strange behaviour:  http://www.openldap.org/lists/openldap-technical/201012/msg00258.html
#
#dn: cn=config
#changetype: modify
#replace: olcSaslHost
#olcSaslHost: ldap.corp.example.com
#-
#replace: olcSaslRealm
#olcSaslRealm: CORP.EXAMPLE.COM
#-


### Using TLS #################################################

# apply to dn: cn=config
#olcTLSCACertificateFile: /etc/ldap/ca-cert.pem
#olcTLSCertificateFile: /etc/ldap/self-ca-cert.pem
#olcTLSCertificateKeyFile: /etc/ldap/self-ca-key.pem
#olcTLSVerifyClient: never


### security consideration ###################################

# http://www.openldap.org/doc/admin24/security.html
#
# The "simple" auth sends password in clear text if not use TLS,
# don't allow "simple" authentication(bind_simple) as we'll reply
# on Kerberos v5, only SASL is allowed.
#
# Explictly disable annoymous(bind_anon) and unauthenticated(bind_anon_cred)
# modes of "simple" method.
#
# "-Y EXTERNAL -H ldapi:///" doesn't work if olcSaslSecProps contains "noactive".
# "-Y GSSAPI -H ldap:///" doesn't work if olcSaslSecProps contains "nodict".
# "-Y GSSAPI" doesn't allow transport=56 in olcSecurity.
# SASL negotiation without TLS doesn't allow bind, authc, SASL, strong in olcRequires,
# these properties disallows "ldapwhoami", you must use "ldapwhoami -Y GSSAPI" or
# explictly specify SASL_MECH in /etc/ldap/ldap.conf or ~/.ldaprc or ./ldaprc.
#
# GSSAPI has hardcoded ssf 56.
#
dn: cn=config
changetype: modify
replace: olcDisallows
olcDisallows: bind_anon bind_simple tls_2_anon tls_authc
-
replace: olcLocalSSF
olcLocalSSF: 128
-
replace: olcSaslSecProps
olcSaslSecProps: noanonymous,noplain,minssf=56
-


dn: olcDatabase={-1}frontend,cn=config
changetype: modify
replace: olcRequires
olcRequires: bind LDAPv3 authc SASL strong
-
replace: olcSecurity
olcSecurity: ssf=56 update_ssf=56 update_transport=56 simple_bind=112
-


#dn: olcDatabase={-1}frontend,cn=config
#changetype: modify
#replace: olcSizeLimit
#olcSizeLimit: ....

#dn: olcDatabase={-1}frontend,cn=config
#changetype: modify
#replace: olcTimeLimit
#olcTimeLimit: ....

